# 编译原理

### 编译过程

介绍三个比较重要的概念：抽象语法树、静态单赋值、指令集

1. <strong>抽象语法树</strong>：（abstract syntax tree, AST) 是源代码语法结构的一种抽象表示，用树状的方式表示编程语言的语法结构，

   作为编译器常用的数据结构，抽象语法树抹去了源代码中一些不重要的字符，如空格、分号、括号等，

   并且会辅助编译器进行语义分析，可以用它来确定语法正确的程序是否存在一些类型不匹配的问题。

2. <strong>静态单赋值</strong>：（static single assignment,SSA) 是中间代码的特性：中间代码中每个变量只会被赋值一次，

   因为 SSA 的主要作用是对代码进行优化，所以它是编译器后端的一部分。

3. <strong>指令集：</strong>开发过程中常遇到的情况「在本地开发环境编译和运行正常的代码在生产环境却无法正常工作」，原因有很多，

   而不同机器使用不同指令集可能是原因之一，容器的诞生也解决了这个令人头疼的问题，当然还有很多其他办法。

   `uname -m` 获得当前机器的硬件信息，x86、ARM 是比较常见的指令集，MacBook M1 芯片后一般是 ARM，

   不同的处理器使用不同的架构和机器语言，所以为了在不同的机器上运行，编程语言一般根据架构翻译成不同的机器代码。

   <strong>复杂指令集计算机(CISC)和精简指令集计算机(RISC)</strong>是两种遵循不同设计理念的指令集，二者没有绝对的优劣。

编译器最重要的几个阶段：词法分析、语法分析、语义分析(类型检查)、中间代码生成、代码优化、代码生成(机器码生成)，

在逻辑上可以分成四个阶段：词法分析与语法分析、类型检查、中间代码生成、机器代码生成：

1. <strong>词法分析与语法分析</strong>：词法分析通过解析源代码文件，将文件中的字符串序列转换成 Token 序列，

   语法分析的输入是词法分析器（lexer）输出的 Token 序列，按照编程语言定义好的文法（grammer）顺序解析，生成语法树，

   <strong><em>Go 语言的语法分析器使用的是 `LALR(1)` 的文法</em></strong>

   每一个 Go 源代码文件最终会被归纳成一个 SourceFile 结构：由 package 定义，由多条 import 语句以及顶层声明组成，

   `SourceFile = PackageClause ";" { ImportDecl ";" } { TopLevelDecl ";" } .`

   语法解析过程中发生的任何语法错误都会被语法分析器发现并将消息打印到 `Stdout`，编译过程也会随着错误出现而终止。

   
   
   

